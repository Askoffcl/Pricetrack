{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />


    
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="{% static 'products/myShopProduct.css' %}" />

  </head>

  <body>



    <header class="navbar">
      <p class="leftnav"><a href="/">Price Track</a></p>
      <div class="rightnav">
        
        
        {% if request.user.role == 'admin' %}
        <a href="/homepage">Home</a>
        <a href="/about">About</a>
        <a href="/logout">Logout</a>
        {% elif request.user.role == 'User' %}
        <a href="/homepage">Home</a>
        <a href="#">About</a>
        <a href="/logout">Logout</a>
        {% elif request.user.role == 'retailer' %}
        <a href="/homepage">Home</a>
        <a href="/about">About</a>
        <a href="/logout">Logout</a>
        
        {% else %}
        <a href="/about">About</a>
        <a href="/userregistration">Register</a>
        <a href="/shopregister">Register as Organizer</a>
        <a href="/login">Login</a>
        {% endif %} 
        
        {% if search == 1 %}
        <form method="get" class="search" action="{% url 'productsearch' %}">
          <input type="text" name="search" placeholder="Search products..." />
          <button type="submit">Search</button>
        </form>
        {% endif %}
        {% if search == 2 %}
        <form method="get" class="search" action="{% url 'shopSearch' %}">
          <input type="text" name="search" placeholder="Search products..." />
          <button type="submit">Search</button>
        </form>
        {% endif %}
      
      </div>
    </header>
  
    {% if messages %}
    <div id="toast-container">
        {% for message in messages %}
            <div class="toast alert alert-{{ message.tags }} text-{{message.tags}}">{{ message }}</div>
        {% endfor %}
    </div>
{% endif %}
     
    {% block content %} {% endblock %}
    
        
        {% if request.user.role == 'admin' %}
      
        {% elif request.user.role == 'User' %}
   
        {% elif request.user.role == 'retailer' %}
    
        {% else %}
    
         <footer class="footer">
  <p>&copy; 2025 PriceCompare. All rights reserved.</p>
</footer>
        {% endif %}
   
  </body>
 
<script>
    // Automatically fade out toast messages after 3 seconds
    document.addEventListener('DOMContentLoaded', function () {
        const toasts = document.querySelectorAll('.toast');
        toasts.forEach(toast => {
            setTimeout(() => {
                toast.style.transition = 'opacity 0.5s ease';
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 1000); // Remove the element after fade-out
            }, 3000);
        });
});
</script>
</html>




  {% load static %}



<div class="full">
  <div class="side">
    <a href="/product/orderplaced"><button>Order Placed</button></a>


      {% if request.user.role == 'User' %}
                   <a href="/product/viewshopProduct"><button>Products</button></a>
                    <a href="/product/viewCart"><button>View Cart</button></a>
                   {% endif %}
    {% if request.user.role == 'retailer' %}
    <a href="/product/viewproducts"><button>Add Products</button></a>
     <a href="/product/viewshopProduct"><button>My Products</button></a>
    <a href="/product/viewFeedback"><button>View Feedback</button></a>
    <a href="/product/viewallreq"><button>My Request</button></a>

    {% endif %} 
    {% if request.user.is_superuser %}
      <a href="/product/viewshopProduct"><button>Products</button></a>
    <a href="/product/category"><button>Category</button></a>
    <a href="/product/viewproducts"><button>Admin Products</button></a>
    <a href="/product/addproducts"><button>Add Products</button></a>
    <a href="/product/viewComplaint"><button>Complaints</button></a>
    <a href="/product/notavailable"><button>Request</button></a>
    <a href="/product/viewShopowner"><button>View Shopowners</button></a>
    <a href="/product/viewShopuser"><button>View ShopUsers</button></a>
    <a href="/product/requestHistory"><button>Request History</button></a>

    {% endif %} 
    {% if not request.user.is_superuser %}

 
    <a href="{% url 'complaint' user.id %}"><button>Any complaints</button></a>
    <a href="/product/complaintStatus"><button>Complaint status</button></a>
    {% endif %}
  </div>
</div>



  {%if request.user.role == 'User' %}
<div class="dropdown">
  <button class="dropbtn">Filter by Category</button>
  <div class="dropdown-content">
    {% for cat in cats %}
    <a href="{% url 'filters' cat.id %}">{{cat.name}}</a>
    {% endfor %}
  </div>
</div>
{% endif %}
<div class="productsgrid">
  {% if recommended %}
<div class="recommended">
  <h2>Recommended Product (Lowest Price)</h2>
  <p><strong>Name:</strong> <a href="{% url 'detail' recommended.id %}" class="lin">{{ recommended.productname }}</a></p>
  <p><strong>Brand:</strong> {{ recommended.productid.brand }}</p>
  <p><strong>ShopName:</strong> {{ recommended.shopid.shopname }}</p>
  <p><strong>Price:</strong> ₹{{ recommended.price }}</p>

  {% if recommended.image %}
  <img
    src="{{ recommended.image.url }}"
    alt="{{ recommended.productname }}"
    style="width: 400px; margin-top: 10px; height: 250px"
  />
  {% endif %}

  {% if not request.user.is_superuser %}
  <div class="action mt-3">
    {% if recommended.quantityAvailable != 0 %}
      <a href="{% url 'cart' recommended.id %}">
        <button type="button" class="btn btn-primary">Add to cart</button>
      </a>
      <a href="{% url 'checkout' recommended.id %}">
        <button type="button" class="btn btn-success">Buy</button>
      </a>
    {% else %}
      <p><strong>Quantity Available:</strong> Out of Stock</p>
    {% endif %}

    <!-- Review Button -->
     
    <button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#reasonModalRecommended">
      Review
    </button>
  </div>
  {% endif %}
</div>

<!-- Modal for Recommended Product Review -->
<div class="modal fade" id="reasonModalRecommended" tabindex="-1" aria-labelledby="reasonModalLabelRecommended" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content ">
      <div class="modal-header">
        <h5 class="modal-title" id="reasonModalLabelRecommended">Feedback for {{ recommended.productname }}</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        {% if fed %}
          {% for feedback in fed %}
            {% if feedback.productid.id == recommended.id %}
              <div class="feedback border-bottom mb-3 pb-2">
                <h6>{{ feedback.user.username }}</h6>
                <div class="rating">
                  <p>Rating: {{ feedback.rating }}</p>
                </div>
                <p class="comment">{{ feedback.comment }}</p>
                <p class="text-muted">By {{ feedback.userid.username }}</p>
              </div>
            {% endif %}
          {% endfor %}
        {% else %}
          <p>No feedback available.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endif %}
 
  
  {% for pro in products %}
 
  <div class="acard">
    {% if pro.image %}
    <img src="{{ pro.image.url }}" alt="{{ pro.productname }}" />
    {% else %}
    <img
      src="https://via.placeholder.com/300x180?text=No+Image"
      alt="No Image"
    />
    {% endif %}
    <p>
      <strong>Name:</strong>
      <a href="{% url 'detail' pro.id %}" class="lin">{{ pro.productname }}</a>
    </p>
    <p><strong>ShopName:</strong> {{ pro.shopid.shopname}}</p>
    <p><strong>Price:</strong> ₹{{ pro.price }}</p>
    {% if pro.quantityAvailable == 0 %}
    <p><strong>Quantity Available:</strong> Out of Stock</p>
    {% else %}
        <p><strong>Quantity Available:</strong> {{ pro.quantityAvailable }}</p>
        {% endif %}
    {% if not request.user.is_superuser %}
    
      {% if request.user.role == 'User' %}
      <button type="button" data-bs-toggle="modal" data-bs-target="#reasonModal{{ pro.id }}">
    Review
</button>
{% endif %}
  {% endif %}
    {% if request.user.role == 'User' %}
            
    <div class="actions">
                 {% if pro.quantityAvailable != 0 %}
             <a href="{% url 'cart' pro.id %}"><button type="button">Add to cart</button></a>
             
      <a href="{% url 'checkout' pro.id %}"><button type="button">Buy</button></a>  
        {% endif %}


   
    </div>
{% endif %}
  



  </div>
  
 <div class="modal fade" id="reasonModal{{ pro.id }}" tabindex="-1" aria-labelledby="reasonModalLabel{{ pro.id }}" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content ">
      <div class="modal-header">
        <h5 class="modal-title" id="reasonModalLabel{{ pro.id }}">Feedback for {{ pro.productname }}</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        {% if fed %}
          {% for feedback in fed %}
            {% if feedback.productid.id == pro.id %}
              <div class="feedback border-bottom mb-3 pb-2">
                <h6>{{ feedback.user.username }}</h6>
                <div class="rating">
                  <p>Rating: {{ feedback.rating }}</p>
                </div>
                <p class="comment">{{ feedback.comment }}</p>
                <p class="text-muted">By {{ feedback.userid.username }}</p>
              </div>
            {% endif %}
          {% endfor %}
        {% else %}
          <p>No feedback available.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>

  
      {% endfor %} 
  {% if not products %}
  <h2 style="margin-left: 430px; font-size: 30px">No products found.</h2>
  {% endif %}

  
</div>










